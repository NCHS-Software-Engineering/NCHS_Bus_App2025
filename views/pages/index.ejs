<!DOCTYPE html>
<html>
    <head>
        <title>NCHS Bus Status Page</title>

        <link rel="icon" type="image/png" href="/images/Naperville_Central_Logo.png">

        <!-- Latest compiled and minified CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

        <!-- Latest compiled JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>


        <link href="https://cdn.syncfusion.com/ej2/22.1.34/ej2-icons/styles/bootstrap5.css" rel="stylesheet"/>
        <link href="https://cdn.syncfusion.com/ej2/22.1.34/ej2-icons/styles/material.css" rel="stylesheet"/>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="referrer" content="no-referrer-when-downgrade" />
        <meta name="google-site-verification" content="Ylp0UBYDFaaNsDJs8DcM8Cw1ImHAHrgMfkQmdg7Y2As" />
        <meta name="description" content="Displays the Statuses of Busses at NCHS after school days.">
        
        <link rel="stylesheet" href="/css/index.css">
    </head>

    <body>
        <nav id="navbar" class="navbar navbar-expand navbar-dark">
            <a class="navbar-brand">
                <img src="/images/Naperville_Central_Logo.png" id = "nchsLogo" alt="NCHS Logo">
            </a>
            <h1>Bus Status</h1>
            
            <div class="navbar-nav ms-auto">
                <div id="g_id_onload"
                    data-client_id="790808137804-5os0c3tvpvlc3jk5lnid1fla44e9qd0k.apps.googleusercontent.com"
                    data-context="signin"
                    data-ux_mode="redirect"
                    data-login_uri="https://nchsbusapp.org/auth"
                    data-auto_prompt="false">
                </div>
                <div><button class="navbuttons" onclick = "toggleNotifs()" type="button">üîî</button></div>
                <script>
                    function toggleNotifs() {
                        const popup = document.getElementById('popupNotifs');
                        const notifStat = document.getElementById('notifStatus');
                        popup.style.display = (popup.style.display === 'flex') ? 'none' : 'flex';
                        requestPermission()

                        if (Notification.permission === "denied"){
                            notifStat.innerHTML = `It seems that the device has denied notification permissions. Try pressing the tune icon <image style='height: 23px; padding: 1px;' src='/public/images/tune.png'></image> in the top left of your screen, then reset all permissions. Reload the website and press the bell icon üîî again. Make sure to press 'allow' once the app request permissions for notifications.`
                        }
                        else if (Notification.permission === "granted"){
                            notifStat.innerHTML = `Notifications are working! You are all good to go! If you have issues, try pressing the tune icon <image style='height: 23px; padding: 1px;' src='/public/images/tune.png'></image> in the top left of your screen, then reset all permissions. Reload the website and press the bell icon üîî again. Make sure to press "allow" once the app request permissions for notifications.`
                        }
                        else {
                            notifStat.innerHTML = `Something doesn't seem right. We have sent a request to show notifications. If it doesn't show up, try pressing the tune icon <image style='height: 23px; padding: 1px;' src='/public/images/tune.png'></image> in the top left of your screen, then reset all permissions. Reload the website and press the bell icon üîî again. Make sure to press "allow" once the app request permissions for notifications.`
                        }

                    }
                    function closeNotifs(){
                        const popup = document.getElementById('popupNotifs');
                        popup.style.display = (popup.style.display === 'flex') ? 'none' : 'flex';
                    }
                </script>
                <div><button class="navbuttons" onclick = "toggleInfo()" type="button">‚ù§Ô∏è</button></div>
                <script>
                    function toggleInfo() {
                        const popup = document.getElementById('popupInfo');
                        popup.style.display = (popup.style.display === 'flex') ? 'none' : 'flex';
                    }
                </script>
                <div class="g_id_signin"
                    data-type="google"
                    data-shape="rectangular"
                    data-theme="outline"
                    data-text="signin"
                    data-size="large"
                    data-logo_alignment="left"
                    data-auto_select="false"
                    style="margin-right: 10px; width: 43px;">
                </div>
            </div>
        </nav>
        <div id="returntohome" onclick="location.href='/'"></div> 
        <table id="busTable"  class="bus-table">
            <tr>
                <th>Bus Number</th> 
                <th>Bus Changes</th>
                <th>Current Status</th>
                <th>Time</th>
                <th>Star</th>
            </tr>
        </table>

        <div class="popup-overlay" id="popupNotifs">
            <div class="popup">
                <h3 style = "padding-bottom: 10px;">Notifications</h3>
                <div id = "notifStatus">
                    
                </div>
                
              <button class="close-btn" onclick="closeNotifs()">Close</button>
            </div>
        </div>
        <div class="popup-overlay" id="popupInfo">
            <div class="popup">
                <h3 style = "padding-bottom: 10px;">About The App</h3>
                <p style="text-align: center; color: grey;">
                    <small>This app tracks bus status, changes, arrival and departure times, and allows the user to star buses. When starring a bus, you receive live notifications for that specific bus, regardless if you have the browser open or not. Not receiving notifications? Click the bell icon üîî!</small>
                </p>
                <h3 style = "padding: 10px;">Developers</h3>
                <p style="text-align: center; color: grey;"><small>Version 1 Created by Simi Kama ('23), Adesh Kumar ('23), Theodore Ng ('23), </small><small class = "easteregg" onclick="hmm()">Alex Remiasz ('23), </small><small> and Boris Rokhmanov ('23)</small><br>
                <small>Version 2 Created by Vinay Narahari ('24), Tyler Browning ('24), and Peter Paik ('24)</small><br>
                <small>Version 3 Created by  Priya Agrawal ('25), Ryan Keough ('25), and </small><small class = "easteregg" onclick="spawnmaxwell()">Andy Liang ('26) </small></p>
                <audio id="maxwell-audio" src="/public/music/maxwell.mp3"></audio>
                
              <button class="close-btn" onclick="toggleInfo()">Close</button>
            </div>
        </div>
        <div style = "padding-top: 10px;"></div>
        <!-- Google sign in script-->
        <script src="https://accounts.google.com/gsi/client" async defer></script>
        <script src = "/public/js/main.js" type = "module"></script>
    </body>
</html>
